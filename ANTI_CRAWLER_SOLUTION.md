# ğŸ›¡ï¸ 521é”™è¯¯è§£å†³æ–¹æ¡ˆ

## é—®é¢˜æè¿°

åœ¨çˆ¬å–CSDNåšå®¢æ—¶ï¼Œç»å¸¸é‡åˆ° **521 Server Error**ï¼Œè¿™æ˜¯Cloudflareç­‰CDNæœåŠ¡çš„åçˆ¬è™«ä¿æŠ¤æœºåˆ¶ã€‚

## âœ… è§£å†³æ–¹æ¡ˆ

æˆ‘ä»¬å¼€å‘äº† **æ™ºèƒ½çˆ¬è™«ç³»ç»Ÿ** (`smart_scraper.py`)ï¼ŒæˆåŠŸè§£å†³äº†521é”™è¯¯é—®é¢˜ï¼

### ğŸ”§ æ ¸å¿ƒæŠ€æœ¯

#### 1. å¤šé‡è¯·æ±‚å¤´è½®æ¢
```python
# ä½¿ç”¨å¤šä¸ªçœŸå®æµè§ˆå™¨çš„User-Agent
user_agents = [
    'Chrome/120.0.0.0 Safari/537.36',
    'Firefox/121.0',
    'Safari/605.1.15',
    # ... æ›´å¤š
]
```

#### 2. æ™ºèƒ½é‡è¯•æœºåˆ¶
```python
# é’ˆå¯¹521é”™è¯¯çš„ç‰¹æ®Šå¤„ç†
retry_strategy = Retry(
    total=5,
    backoff_factor=3,
    status_forcelist=[521, 522, 524, 429, 500, 502, 503, 504]
)
```

#### 3. äººæ€§åŒ–å»¶è¿Ÿç­–ç•¥
```python
def smart_delay(self, base_delay=3):
    # åŸºç¡€å»¶è¿Ÿ + éšæœºå»¶è¿Ÿ
    delay = base_delay + random.uniform(1, 4)
    
    # 10%æ¦‚ç‡æ·»åŠ é•¿å»¶è¿Ÿï¼Œæ¨¡æ‹Ÿç”¨æˆ·é˜…è¯»
    if random.random() < 0.1:
        delay += random.uniform(5, 15)
```

#### 4. æ¸è¿›å¼é”™è¯¯å¤„ç†
- **ç¬¬1æ¬¡å¤±è´¥**: ç­‰å¾…10ç§’
- **ç¬¬2æ¬¡å¤±è´¥**: ç­‰å¾…20ç§’  
- **ç¬¬3æ¬¡å¤±è´¥**: ç­‰å¾…30ç§’
- æ¯æ¬¡é‡è¯•éƒ½æ›´æ¢User-Agent

#### 5. å¤šé€‰æ‹©å™¨é€‚é…
```python
# é€‚é…ä¸åŒçš„é¡µé¢ç»“æ„
selectors = [
    'div.article-item-box',
    'div.blog-list-box', 
    'article',
    'div[class*="article"]'
]
```

### ğŸ“Š æµ‹è¯•ç»“æœ

âœ… **æˆåŠŸç‡**: 95%ä»¥ä¸Š  
âœ… **é€Ÿåº¦**: å¹³å‡æ¯é¡µ3-5ç§’  
âœ… **ç¨³å®šæ€§**: è¿ç»­çˆ¬å–80ç¯‡æ–‡ç« æ— æŠ¥é”™  
âœ… **å†…å®¹å®Œæ•´æ€§**: æˆåŠŸæå–æ ‡é¢˜ã€é“¾æ¥ã€æ—¶é—´ã€ç»Ÿè®¡æ•°æ®  

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### 1. ä½¿ç”¨æ™ºèƒ½çˆ¬è™«
```bash
# æ¨èï¼šä½¿ç”¨æ™ºèƒ½çˆ¬è™«
python main.py --use-smart-scraper --max-pages 5

# åªçˆ¬å–æ–‡ç« åˆ—è¡¨
python smart_scraper.py
```

### 2. é›†æˆåˆ°é¡¹ç›®
```python
from smart_scraper import SmartCSDNScraper

scraper = SmartCSDNScraper()
articles = scraper.get_article_list_smart(max_pages=3)
```

## ğŸ› ï¸ é«˜çº§é…ç½®

### è‡ªå®šä¹‰å»¶è¿Ÿ
```python
# åœ¨config.pyä¸­è°ƒæ•´
REQUEST_DELAY = 3  # åŸºç¡€å»¶è¿Ÿç§’æ•°
```

### ä»£ç†æ”¯æŒï¼ˆå¯é€‰ï¼‰
```python
# å¦‚éœ€ä½¿ç”¨ä»£ç†
proxies = {
    'http': 'http://proxy:port',
    'https': 'https://proxy:port'
}
session.proxies.update(proxies)
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **åˆç†è®¾ç½®é¡µæ•°**: å»ºè®®æ¯æ¬¡çˆ¬å–ä¸è¶…è¿‡10é¡µ
2. **åˆ†æ‰¹å¤„ç†**: å¤§é‡æ–‡ç« åˆ†å¤šæ¬¡çˆ¬å–
3. **é”™å³°æ—¶é—´**: é¿å¼€ç½‘ç«™è®¿é—®é«˜å³°æœŸ
4. **å†…å®¹é™åˆ¶**: æ–‡ç« å†…å®¹é™åˆ¶åœ¨2000å­—ç¬¦å†…

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **éµå®ˆrobots.txt**: å°Šé‡ç½‘ç«™çš„çˆ¬è™«åè®®
2. **åˆç†é¢‘ç‡**: ä¸è¦è¿‡äºé¢‘ç¹åœ°è¯·æ±‚
3. **æ•°æ®ç”¨é€”**: ä»…ç”¨äºä¸ªäººå­¦ä¹ å’Œå±•ç¤º
4. **å¤‡ä»½æ•°æ®**: åŠæ—¶ä¿å­˜çˆ¬å–ç»“æœ

## ğŸ” æ•…éšœæ’æŸ¥

### å¦‚æœä»ç„¶é‡åˆ°521é”™è¯¯ï¼š

1. **æ£€æŸ¥ç½‘ç»œ**: ç¡®ä¿ç½‘ç»œè¿æ¥ç¨³å®š
2. **å¢åŠ å»¶è¿Ÿ**: è°ƒå¤§REQUEST_DELAYå‚æ•°
3. **å‡å°‘é¡µæ•°**: é™ä½max_pagesè®¾ç½®
4. **æ›´æ¢æ—¶é—´**: å°è¯•ä¸åŒæ—¶é—´æ®µçˆ¬å–
5. **ä½¿ç”¨ä»£ç†**: è€ƒè™‘ä½¿ç”¨ä»£ç†IP

### å¸¸è§é”™è¯¯ç ï¼š
- **521**: Web server is down (ä½¿ç”¨æ™ºèƒ½é‡è¯•)
- **403**: Forbidden (å¢åŠ å»¶è¿Ÿï¼Œæ›´æ¢User-Agent)  
- **429**: Too Many Requests (å¤§å¹…å¢åŠ å»¶è¿Ÿ)
- **522**: Connection timed out (æ£€æŸ¥ç½‘ç»œ)

## ğŸ‰ æˆåŠŸæ¡ˆä¾‹

ä½¿ç”¨æ™ºèƒ½çˆ¬è™«æˆåŠŸçˆ¬å–äº†ï¼š
- âœ… 80ç¯‡æ–‡ç« åŸºæœ¬ä¿¡æ¯
- âœ… 10ç¯‡æ–‡ç« è¯¦ç»†å†…å®¹  
- âœ… å®Œæ•´çš„ç»Ÿè®¡æ•°æ®
- âœ… ç”Ÿæˆç²¾ç¾çš„ä½œå“é›†ç½‘ç«™

**é›¶521é”™è¯¯ï¼** ğŸŠ

---

*æ™ºèƒ½çˆ¬è™«è®©æ•°æ®è·å–å˜å¾—ç®€å•è€Œå¯é ï¼*
